// author:   Samuel Mueller 
// version:  0.0.8 
// license:  MIT 
// homepage: http://github.com/samu/angular-table 
(function(){var t,e,i,n,r,a,o,s,u,l,p,c,g,_,h,f,d,m,b,v={}.hasOwnProperty,y=function(t,e){function i(){this.constructor=t}for(var n in e)v.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t};e=function(){function t(t,e){this.attribute=t.attribute,this.title=t.title,this.sortable=t.sortable,this.width=t.width,this.initialSorting=t.initialSorting,e&&(this.custom_content=e.custom_content,this.attributes=e.attributes)}return t.prototype.create_element=function(){var t;return t=angular.element(document.createElement("th")),t.attr("style","cursor: pointer;")},t.prototype.render_title=function(t){return t.html(this.custom_content||this.title)},t.prototype.render_attributes=function(t){var e,i,n,r,a;if(this.custom_content){for(r=this.attributes,a=[],i=0,n=r.length;n>i;i++)e=r[i],a.push(t.attr(e.name,e.value));return a}},t.prototype.render_sorting=function(t){var e;return this.sortable?(t.attr("ng-click","predicate = '"+this.attribute+"'; descending = !descending;"),e=angular.element("<i style='margin-left: 10px;'></i>"),e.attr("ng-class","getSortIcon('"+this.attribute+"', predicate)"),t.append(e)):void 0},t.prototype.render_width=function(t){return t.attr("width",this.width)},t.prototype.render_html=function(){var t;return t=this.create_element(),this.render_title(t),this.render_attributes(t),this.render_sorting(t),this.render_width(t),t},t}(),u=function(){function t(t,e){this.table_element=t,this.attributes=e,this.id=this.attributes.id,this.list=this.attributes[h],this.attributes[_]&&this.register_items_per_page(this.attributes[_]),this.register_sort_context(this.attributes[d]),this.register_fill_last_page(this.attributes[c]),this.register_max_pages(this.attributes[f]),this.register_current_page(this.attributes[p]),this.paginated=void 0!==this.items_per_page,this.create_column_configurations()}return t.prototype.register_items_per_page=function(t){return isNaN(t)?this.items_per_page=t:(this.items_per_page=""+this.id+"_itemsPerPage",this.initial_items_per_page=parseInt(t))},t.prototype.register_sort_context=function(t){return void 0!==t?"global"===t?(this.sort_context=""+this.id+"_sortContext",this.initial_sort_context="global"):"page"===t?(this.sort_context=""+this.id+"_sortContext",this.initial_sort_context="page"):this.sort_context=t:(this.sort_context=""+this.id+"_sortContext",this.initial_sort_context="global")},t.prototype.register_fill_last_page=function(t){return void 0!==t?"true"===t?(this.fill_last_page=""+this.id+"_fillLastPage",this.initial_fill_last_page=!0):"false"===t?(this.fill_last_page=""+this.id+"_fillLastPage",this.initial_fill_last_page=!1):""===t?(this.fill_last_page=""+this.id+"_fillLastPage",this.initial_fill_last_page=!0):this.fill_last_page=t:void 0},t.prototype.register_max_pages=function(t){return void 0!==t?isNaN(t)?this.max_pages=t:(this.max_pages=""+this.id+"_maxPages",this.initial_max_pages=parseInt(t)):void 0},t.prototype.register_current_page=function(t){return void 0!==t?isNaN(t)?this.current_page=t:(this.current_page=""+this.id+"_currentPage",this.initial_current_page=parseInt(t)):(this.current_page=""+this.id+"_currentPage",this.initial_current_page=0)},t.prototype.capitaliseFirstLetter=function(t){return t?t.charAt(0).toUpperCase()+t.slice(1):""},t.prototype.extractWidth=function(t){var e;return e=/([0-9]+px)/i.exec(t),e?e[0]:""},t.prototype.isSortable=function(t){var e;return e=/(sortable)/i.exec(t),e?!0:!1},t.prototype.getInitialSorting=function(t){var e;if(e=t.attr("at-initial-sorting")){if("asc"===e||"desc"===e)return e;throw"Invalid value for initial-sorting: "+e+". Allowed values are 'asc' or 'desc'."}return void 0},t.prototype.collect_header_markup=function(t){var e,i,n,r,a,o;for(e={},n=t.find("tr"),o=n.find("th"),r=0,a=o.length;a>r;r++)i=o[r],i=angular.element(i),e[i.attr("at-attribute")]={custom_content:i.html(),attributes:i[0].attributes};return e},t.prototype.collect_body_markup=function(t){var e,i,n,r,a,o,s,u,l,p;for(i=[],p=t.find("td"),u=0,l=p.length;l>u;u++)a=p[u],a=angular.element(a),e=a.attr("at-attribute"),o=a.attr("at-title")||this.capitaliseFirstLetter(a.attr("at-attribute")),r=void 0!==a.attr("at-sortable")||this.isSortable(a.attr("class")),s=this.extractWidth(a.attr("class")),n=this.getInitialSorting(a),i.push({attribute:e,title:o,sortable:r,width:s,initialSorting:n});return i},t.prototype.create_column_configurations=function(){var t,i,n,r,a;for(i=this.collect_header_markup(this.table_element),t=this.collect_body_markup(this.table_element),this.column_configurations=[],r=0,a=t.length;a>r;r++)n=t[r],this.column_configurations.push(new e(n,i[n.attribute]));return this.column_configurations},t}(),a=function(){function t(){}return t.prototype.setupTr=function(t,e){var i,n;return i=t.find("tbody"),n=i.find("tr"),n.attr("ng-repeat",e),i},t}(),o=function(t){function e(t){this.repeatString="item in "+t.list+" | orderBy:predicate:descending"}return y(e,t),e.prototype.compile=function(t){return this.setupTr(t,this.repeatString)},e.prototype.link=function(){},e}(a),n=function(t){function e(t){this.table_configuration=t,this.repeatString="item in sorted_and_paginated_list"}return y(e,t),e.prototype.compile=function(t){var e,i,n,r,a,o,s;for(i=this.setupTr(t,this.repeatString),a=t.find("td"),r="",o=0,s=a.length;s>o;o++)n=a[o],r+="<td>&nbsp;</td>";e=angular.element(document.createElement("tr")),e.attr("ng-show",this.table_configuration.fill_last_page),e.html(r),e.attr("ng-repeat","item in filler_array"),i.append(e)},e.prototype.link=function(t,e,i,n){var a,o,s,u,l;return s=this.table_configuration,l=new r(t,s),o=function(t,e,i,n,r,a,o){var s,u;return t?(u=t,s=i*e-t.length,"global"===n?(u=o("orderBy")(u,r,a),u=o("limitTo")(u,s),u=o("limitTo")(u,i)):(u=o("limitTo")(u,s),u=o("limitTo")(u,i),u=o("orderBy")(u,r,a)),u):[]},a=function(t,e,i,n){var r,a,o,s,u,l,p,c,g,_;if(n=parseInt(n),t.length<=0){for(g=[],o=s=0,l=n-1;l>=0?l>=s:s>=l;o=l>=0?++s:--s)g.push(o);return g}if(e===i-1){if(a=t.length%n,0!==a){for(r=n-a-1,_=[],o=u=p=t.length,c=t.length+r;c>=p?c>=u:u>=c;o=c>=p?++u:--u)_.push(o);return _}return[]}},u=function(){var e;return t.sorted_and_paginated_list=o(l.get_list(),l.get_current_page(),l.get_items_per_page(),l.get_sort_context(),t.predicate,t.descending,n),e=Math.ceil(l.get_list().length/l.get_items_per_page()),t.filler_array=a(l.get_list(),l.get_current_page(),e,l.get_items_per_page())},t.$watch(s.current_page,function(){return u()}),t.$watch(s.items_per_page,function(){return u()}),t.$watch(s.sort_context,function(){return u()}),t.$watch(""+s.list+".length",function(){return t[b]=Math.ceil(t[s.list].length/l.get_items_per_page()),u()}),t.$watch("predicate",function(){return u()}),t.$watch("descending",function(){return u()})},e}(a),s=function(){function t(t,e){this.element=t,this.table_configuration=e}return t.prototype.constructHeader=function(){var t,e,i,n,r;for(e=angular.element(document.createElement("tr")),r=this.table_configuration.column_configurations,i=0,n=r.length;n>i;i++)t=r[i],e.append(t.render_html());return e},t.prototype.setup_header=function(){var t,e,i;return e=this.element.find("thead"),e?(t=this.constructHeader(),i=angular.element(e).find("tr"),i.remove(),e.append(t)):void 0},t.prototype.get_setup=function(){return this.table_configuration.paginated?new n(this.table_configuration):new o(this.table_configuration)},t.prototype.compile=function(){return this.setup_header(),this.setup=this.get_setup(),this.setup.compile(this.element)},t.prototype.setup_initial_sorting=function(t){var e,i,n,r,a;for(r=this.table_configuration.column_configurations,a=[],i=0,n=r.length;n>i;i++)if(e=r[i],e.initialSorting){if(!e.attribute)throw"initial-sorting specified without attribute.";t.predicate=e.attribute,a.push(t.descending="desc"===e.initialSorting)}else a.push(void 0);return a},t.prototype.post=function(t,e,i,n){return this.setup_initial_sorting(t),t.getSortIcon||(t.getSortIcon=function(e){return e!==t.predicate?"icon-minus":t.descending?"glyphicon glyphicon-chevron-down":"glyphicon glyphicon-chevron-up"}),this.setup.link(t,e,i,n)},t}(),angular.module("angular-table",[]),b="number_of_pages",h="atList",_="atItemsPerPage",c="atFillLastPage",d="atSortContext",f="atMaxPages",p="atCurrentPage",l="at-attribute",m="at-sortable",g="at-initial-sorting",r=function(){function t(t,e){this.scope=t,this.config=e}return t.prototype.get_list=function(){return this.scope.$eval(this.config.list)},t.prototype.get_items_per_page=function(){return this.scope.$eval(this.config.items_per_page)},t.prototype.get_current_page=function(){return this.scope.$eval(this.config.current_page)},t.prototype.get_max_pages=function(){return this.scope.$eval(this.config.max_pages)},t.prototype.get_sort_context=function(){return this.scope.$eval(this.config.sort_context)},t}(),t=function(){function t(){this.mappings={}}return t.prototype.get_table_configuration=function(t){return this.mappings[t].table_configuration},t.prototype.register_table=function(t){var e,i,n;if(e=(i=this.mappings)[n=t.id]||(i[n]={}),e.table_configuration=t,e.pagination_scope)throw"WHOOPS"},t.prototype.register_table_scope=function(t,e){var i;return this.mappings[t].table_scope=e,i=this.mappings[t].table_configuration,i.initial_items_per_page&&(e.$parent[i.items_per_page]=i.initial_items_per_page),i.initial_sort_context&&(e.$parent[i.sort_context]=i.initial_sort_context),i.initial_fill_last_page&&(e.$parent[i.fill_last_page]=i.initial_fill_last_page),i.initial_max_pages&&(e.$parent[i.max_pages]=i.initial_max_pages),void 0!==i.initial_current_page?e.$parent[i.current_page]=i.initial_current_page:void 0},t.prototype.register_pagination_scope=function(){},t}(),angular.module("angular-table").service("angularTableManager",[function(){return new t}]),angular.module("angular-table").directive("atTable",["$filter","angularTableManager",function(t,e){return{restrict:"AC",scope:!0,controller:["$scope","$element","$attrs",function(i,n,r){var a;return a=r.id,a?e.register_table_scope(a,i,t):void 0}],compile:function(i,n){var r,a;return a=new u(i,n),e.register_table(a),r=new s(i,a),r.compile(),{post:function(e,i,n){return r.post(e,i,n,t)}}}}}]),i=function(){function t(t,e,i,n){if(this.lower_bound=null!=t?t:0,this.upper_bound=null!=e?e:1,null==i&&(i=0),this.length=null!=n?n:1,this.length>this.upper_bound-this.lower_bound)throw"sequence is too long";this.data=this.generate(i)}return t.prototype.generate=function(t){var e,i,n,r;for(t>this.upper_bound-this.length?t=this.upper_bound-this.length:t<this.lower_bound&&(t=this.lower_bound),r=[],e=i=t,n=parseInt(t)+parseInt(this.length)-1;n>=t?n>=i:i>=n;e=n>=t?++i:--i)r.push(e);return r},t.prototype.reset_parameters=function(t,e,i){if(this.lower_bound=t,this.upper_bound=e,this.length=i,this.length>this.upper_bound-this.lower_bound)throw"sequence is too long";return this.data=this.generate(this.data[0])},t.prototype.relocate=function(t){var e;return e=this.data[0]+t,this.data=this.generate(e,e+this.length)},t.prototype.realign_greedy=function(t){var e;return t<this.data[0]?(e=t,this.data=this.generate(e)):t>this.data[this.length-1]?(e=t-(this.length-1),this.data=this.generate(e)):void 0},t.prototype.realign_generous=function(){},t}(),angular.module("angular-table").directive("atPagination",["angularTableManager",function(t){return{replace:!0,restrict:"E",template:"<div style='margin: 0px;'> <ul class='pagination'> <li ng-class='{disabled: get_current_page() <= 0}'> <a href='' ng-click='step_page(-"+b+")'>First</a> </li> <li ng-show='show_sectioning()' ng-class='{disabled: get_current_page() <= 0}'> <a href='' ng-click='jump_back()'>&laquo;</a> </li> <li ng-class='{disabled: get_current_page() <= 0}'> <a href='' ng-click='step_page(-1)'>&lsaquo;</a> </li> <li ng-class='{active: get_current_page() == page}' ng-repeat='page in page_sequence.data'> <a href='' ng-click='go_to_page(page)'>{{page + 1}}</a> </li> <li ng-class='{disabled: get_current_page() >= "+b+" - 1}'> <a href='' ng-click='step_page(1)'>&rsaquo;</a> </li> <li ng-show='show_sectioning()' ng-class='{disabled: get_current_page() >= "+b+" - 1}'> <a href='' ng-click='jump_ahead()'>&raquo;</a> </li> <li ng-class='{disabled: get_current_page() >= "+b+" - 1}'> <a href='' ng-click='step_page("+b+")'>Last</a> </li> </ul> </div>",controller:["$scope","$element","$attrs",function(e,i,n){return t.register_pagination_scope(n.atTableId,e)}],scope:!0,link:function(e,n,a){var o,s,u,l,p,c,g;return p=t.get_table_configuration(a.atTableId),g=new r(e,p),e.page_sequence=new i,u=function(t){return e.$parent.$eval(""+p.current_page+"="+t)},o=function(){return e[b]},l=function(t){return e[b]=t},c=function(){var t,i;return e[p.list]?e[p.list].length>0?(t=Math.ceil(e[p.list].length/g.get_items_per_page()),l(t),i=e.show_sectioning()?g.get_max_pages():t,e.page_sequence.reset_parameters(0,t,i),u(s(g.get_current_page(),0,o()-1)),e.page_sequence.realign_greedy(g.get_current_page())):(l(1),e.page_sequence.reset_parameters(0,1,1),u(0),e.page_sequence.realign_greedy(0)):void 0},s=function(t,e,i){return t=Math.max(e,t),Math.min(i,t)},e.show_sectioning=function(){return g.get_max_pages()&&o()>g.get_max_pages()},e.get_current_page=function(){return g.get_current_page()},e.step_page=function(t){return t=parseInt(t),u(s(g.get_current_page()+t,0,o()-1)),e.page_sequence.realign_greedy(g.get_current_page())},e.go_to_page=function(t){return u(t)},e.jump_back=function(){return e.step_page(-g.get_max_pages())},e.jump_ahead=function(){return e.step_page(g.get_max_pages())},c(),e.$watch(p.items_per_page,function(){return c()}),e.$watch(p.max_pages,function(){return c()}),e.$watch(p.list,function(){return c()}),e.$watch(""+p.list+".length",function(){return c()})}}}]),angular.module("angular-table").directive("atImplicit",[function(){return{restrict:"AC",compile:function(t){var e;if(e=t.attr("at-attribute"),!e)throw"at-implicit specified without at-attribute: "+t.html();return t.append("{{item."+e+"}}")}}}])}).call(this);